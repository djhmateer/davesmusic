@model List<DavesMusic.Controllers.SongsVM>

<script type="text/javascript" src="../../Scripts/jquery-1.10.2.min.js"></script>
<script type="text/javascript">
    $(function(){
        $("[data-hide]").on("click", function(){
            $(this).closest("." + $(this).attr("data-hide")).hide();
        });
    });

    function addTrack(trackId) {
        $.get('@Url.Action("AddOrRemoveTrack")',
            {
                trackId: trackId
            }, function(data) {
                // Success
               
                // change the button title to remove, so user knows it is added already
                //$("#"+data).css("background-color", "blue");
                var messageToDisplay = "";
                if ($("#" + data).text() === "Add") {
                    $("#" + data).text("Delete");
                    $("#" + data).css("margin-left", "50px");
                    messageToDisplay = "Added track: ";
                } else {
                    $("#" + data).text("Add");
                    $("#" + data).css("background-color", "white");
                    $("#" + data).css("margin-left", "0");
                    messageToDisplay = "Removed track: ";
                }
                messageToDisplay = messageToDisplay + data;
                // show alert
                $('#le-alert').show();
                $("#message").html(messageToDisplay);
            }
            //).fail(function() {
            //    alert("error");
            //}
        );
    }
</script>

<h2>Seminal Songs</h2>

<!-- make it so that this passes a null? so can get current users id in the controller-->

@if (ViewBag.user_id == null){
    <p>Please <a href="/Home/LoginRedirect/">login</a> to Spotify so I know where to send your awesome musical choices!</p>
}
else {
    @*<p>Hi: @ViewBag.user_id</p>*@
    <p><a href="/Playlists/Create/">Create/Update this playlist Spotify</a></p>
}

<div id="le-alert" class="alert alert-success" hidden="hidden">
    <button href="#" type="button" class="close" data-hide="alert">&times;</button>
    <div id="message"></div>
</div>


<table>
    @foreach (var item in Model) {
        <tr>
            <td>@item.TrackName</td>
            <td>@item.ArtistName</td>
           
            @if (item.AddedInPlaylist) {
                <td><button id="@item.TrackID" style="margin-left: 50px" onclick="addTrack('@item.TrackID')">Delete</button></td>
            }
            else {
                <td><button id="@item.TrackID" onclick="addTrack('@item.TrackID')">Add</button></td>
            }
        </tr>
    }
</table>


